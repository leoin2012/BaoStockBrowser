# 📖 BaoStock Browser 使用指南

## 💾 行业数据管理功能

### 功能概述

行业数据管理功能允许您查询所有A股的行业分类信息，并将这些信息保存到本地的 `stock_list.csv` 文件中。这样，您的股票列表就会包含每只股票的行业信息，方便后续分析和筛选。

### 使用步骤

#### 1. 查询所有股票的行业分类

1. 启动应用程序（双击 `run.bat` 或运行 `streamlit run baostock_browser.py`）
2. 在左侧菜单中，点击 **🏢 Sector Data** 展开板块数据类别
3. 选择 **query_stock_industry | 行业分类**
4. 在参数区域：
   - **Stock Code (optional)**：留空（不选择任何股票）
   - **Query Date**：选择查询日期（默认为今天）
5. 点击 **Execute Query** 按钮

#### 2. 查看查询结果

查询完成后，右侧会显示所有股票的行业分类信息，包括：

| 字段名称 | 说明 |
|---------|------|
| updateDate | 更新日期 |
| code | 证券代码 |
| code_name | 证券名称 |
| industry | 所属行业 |
| industryClassification | 所属行业类别（申万一级行业） |

#### 3. 保存行业数据到本地

有两种方式可以保存行业数据：

**方式一：在参数区域保存**
1. 在左侧参数区域，向下滚动到 **💾 Save Industry Data** 部分
2. 点击 **💾 Save Industry Data to stock_list.csv** 按钮
3. 等待保存完成，会显示成功提示和庆祝动画 🎉

**方式二：在结果区域保存**
1. 在右侧查询结果区域，找到操作按钮行
2. 点击 **💾 Save to stock_list.csv** 按钮（仅在查询行业数据时显示）
3. 等待保存完成，会显示成功提示

#### 4. 验证保存结果

保存成功后，`stock_list.csv` 文件会被更新，新增或更新以下字段：
- `industry`：所属行业
- `industryClassification`：所属行业类别

您可以：
1. 打开 `stock_list.csv` 文件查看
2. 刷新股票选择器（点击🔄按钮）重新加载数据
3. 在其他查询中使用更新后的股票列表

### 功能特点

✅ **智能合并**：自动将行业信息合并到现有股票列表中  
✅ **增量更新**：只更新行业字段，不影响其他数据  
✅ **数据持久化**：保存到本地CSV文件，无需重复查询  
✅ **安全可靠**：保存前会检查文件是否存在，避免数据丢失  
✅ **即时反馈**：保存成功后立即更新内存中的股票列表  

### 注意事项

⚠️ **首次使用**：如果 `stock_list.csv` 不存在，请先刷新股票列表（在任意股票选择器旁点击🔄按钮）

⚠️ **数据覆盖**：如果 `stock_list.csv` 中已有行业数据，保存操作会覆盖旧数据

⚠️ **查询限制**：BaoStock API 的行业分类数据每周一更新

⚠️ **文件编码**：CSV文件使用 UTF-8-BOM 编码，确保中文正常显示

### 常见问题

**Q: 为什么保存按钮不显示？**  
A: 保存按钮仅在查询行业数据（query_stock_industry）后显示。如果查询其他数据，按钮会自动隐藏。

**Q: 保存失败怎么办？**  
A: 请检查：
1. `stock_list.csv` 文件是否存在（如不存在，请先刷新股票列表）
2. 文件是否被其他程序占用（如Excel）
3. 是否有足够的磁盘空间

**Q: 如何查看已保存的行业信息？**  
A: 可以直接打开 `stock_list.csv` 文件，或在股票选择器中查看（行业信息会显示在股票名称旁）。

**Q: 可以只保存部分股票的行业信息吗？**  
A: 可以。在查询时指定具体的股票代码，然后保存。系统会只更新该股票的行业信息。

### 高级用法

#### 批量更新行业信息

如果您想定期更新所有股票的行业信息，可以：

1. 查询所有股票的行业分类（Stock Code 留空）
2. 保存到 `stock_list.csv`
3. 设置定期任务（如每周一）自动执行此操作

#### 导出行业分析报告

1. 查询所有股票的行业分类
2. 点击 **📥 Download CSV** 下载原始数据
3. 使用Excel或Python进行进一步分析（如统计各行业股票数量）

#### 结合其他查询使用

保存行业信息后，您可以：
1. 在K线查询中按行业筛选股票
2. 在财务数据查询中进行行业对比分析
3. 在宏观经济数据中分析行业趋势

---

## 🎯 其他功能说明

### 智能股票选择器

所有需要输入股票代码的地方都提供了智能选择器：
- 下拉框显示所有股票（代码 + 名称）
- 支持关键字搜索
- 点击🔄按钮刷新股票列表

### 字段说明提示

查询结果表格中的每个字段都有详细说明：
- **鼠标悬停**：将鼠标放在列名上，会显示字段的详细说明
- **展开查看**：点击 "📖 View All Field Descriptions" 查看所有字段说明

### 数据导出

所有查询结果都可以导出为CSV文件：
1. 点击 **📥 Download CSV** 按钮
2. 选择保存位置
3. 文件名自动包含时间戳，避免覆盖

---

## 📞 技术支持

如有问题或建议，请访问：
- BaoStock官网：[www.baostock.com](http://www.baostock.com)
- 项目GitHub：（如有）

---

**祝您使用愉快！** 📈✨
